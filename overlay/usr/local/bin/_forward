#!/bin/sh
set -euo pipefail
[[ -z ${1+x} ]] && _error "_forward: You must supply the name of the log service."
[[ -z ${2+x} ]] && _error "_forward: You must supply the path to the log file."
[[ -z "${2}" ]] && _echo "_forward: Log file not defined, disabling ${1}" && _disable "${1}" && exit 0

_echo "Forwarding ${1}"

if [[ -e ${2} ]] ; then
    _echo "_forward: ${2}"
    exec tail -F ${2}
else
    SLEEP=5
    _echo "_forward: ${2} not found, sleeping for ${SLEEP}s"
    sleep ${SLEEP}
fi